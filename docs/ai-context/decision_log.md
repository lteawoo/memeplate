# 결정 로그 (Decision Log)

## 2026-02-04: 기술 스택 선정 및 초기 설정
- **프레임워크**: React 19 (Vite) - 최신 React 기능을 활용한 빠른 개발.
- **UI 라이브러리**: Ant Design (antd) 6.x - 최신 디자인 시스템과 컴포넌트 활용.
- **스타일링**: Tailwind CSS 4.x - Ant Design의 세부 간격 보정 및 유틸리티 기반 스타일링.
- **캔버스 라이브러리**: Fabric.js 7.x - ES Module 기반의 최신 API 활용 (Promise 기반 이미지 로딩 등).

## 2026-02-04: PostCSS 및 Tailwind CSS v4 설정 수정
- **이유**: Tailwind CSS v4에서는 `tailwindcss` 직접 호출 방식이 아닌 `@tailwindcss/postcss` 패키지를 별도로 사용해야 함.
- **조치**: `@tailwindcss/postcss` 설치 및 `postcss.config.js` 플러그인 설정 업데이트.

## 2026-02-04: UI/UX 디자인 고도화
- **레이아웃**: Ant Design의 `Tabs`를 사용하여 배경과 텍스트 설정을 분리, 복잡한 편집 도구를 체계화함.
- **사용성 개선**: `Upload.Dragger`를 통한 직관적인 이미지 업로드, 배경 없을 시 Empty state 가이드 제공.
- **단축키 도입**: 사용자 편의를 위해 `Delete`, `Backspace` 키를 통한 객체 삭제 이벤트 리스너 구현.
- **브랜딩**: `theme.useToken()`을 활용하여 Ant Design의 디자인 토큰(색상, 테두리 반경 등)을 앱 전반에 일관되게 적용.

## 2026-02-04: 반응형 UI 및 디자인 시스템 고도화
- **반응형 캔버스**: 브라우저 창 크기에 따라 캔버스 크기가 동적으로 조절되도록 `ResizeObserver` 패턴 적용 (여백 64px 유지).
- **Empty State 개선**: 이미지가 없을 때의 시각적 불일치를 해결하기 위해 캔버스 영역을 전용 업로드 드롭존으로 대체.
- **디자인 규칙 준수**: `GEMINI.md`의 디자인 규칙(8px 그리드, 큰 여백, 200~300ms 애니메이션)을 적용하여 시각적 완성도 향상.
- **환경 최적화**: `package.json`에 `"type": "module"`을 추가하여 PostCSS 설정 관련 빌드 경고 해결.

## 2026-02-04: 아이콘 시스템 교체 및 UI 폴리싱
- **아이콘 라이브러리 변경**: 기존 Ant Design Icons 대신 **Material Design Icons (MDI)** 도입 (`@mdi/js`, `@mdi/react`).
  - **이유**: 더 현대적인 라인 스타일(SVG Path)과 풍부한 아이콘셋 확보, `lucide-react`와 유사한 깔끔한 룩앤필 제공.
- **레이아웃 개선 (User Feedback 반영)**:
  - **헤더**: 불필요한 장식(박스 로고)을 제거하고 타이포그래피 중심의 미니멀 디자인 적용.
  - **사이드바**: 콘텐츠가 모서리에 붙는 문제를 해결하기 위해 `px-8 py-6` 패딩 적용.
  - **푸터**: 다운로드 버튼을 플로팅 스타일(Floating Style)로 변경하여 심미성 향상.
  - **컴포넌트**: 단순 텍스트 태그를 Ant Design `Tag` 컴포넌트로 교체하여 시스템 통일성 강화.


## 2026-02-04: UI 아키텍처 변경 (Tabs → Toolbar)
- **배경**: 편집 기능(텍스트, 도형, 지우개)이 늘어남에 따라 기존의 상단 2개 탭(배경/텍스트) 구조로는 확장이 어려움.
- **결정**: 좌측에 **세로형 아이콘 툴바**를 배치하고, 선택된 도구에 따라 세부 속성 패널을 보여주는 방식으로 변경.
- **이유**:
  1.  **확장성**: 추후 스티커, 필터 등 새로운 기능 추가 용이.
  2.  **직관성**: 텍스트도 '추가하고 수정하는' 하나의 도구로 인식하여 일관된 UX 제공. 포토샵/피그마 등 표준 그래픽 툴의 패턴을 따름.
  3.  **공간 효율**: 좁은 탭 헤더보다 아이콘 툴바가 공간을 덜 차지하며 세련된 느낌을 줌.

## 2026-02-04: 아이콘 시스템 MDI(Material Design Icons) 채택
- **이유**: Ant Design Icons보다 종류가 다양하고, 범용적인 디자인 언어(Material Design)를 따르므로 툴바 아이콘의 일관성을 유지하기 좋음.

## 2026-02-04: Tailwind CSS 4.0 적용
- **내용**: `postcss` 설정과 `@import "tailwindcss";` 문법을 사용하여 최신 CSS 프레임워크 적용.

## 2026-02-04: 도형 도구 UX 개선
- **문제**: 도형의 대각선 크기 조절이 비율이 고정(Uniform Scaling)되어 자유롭지 않고, 다중 선택 시 개별 제어가 불가능함.
- **해결**:
  1.  **자유 변형(Free Transform)**: `uniformScaling: false` 옵션을 적용하여 대각선 드래그 시 가로/세로 비율을 자유롭게 조절 가능하도록 변경.
  2.  **다중 선택 지원**: `getActiveObjects()`를 활용하여 여러 객체를 선택했을 때도 색상 변경 및 삭제가 일괄 적용되도록 로직 수정.
  3.  **아이콘 교체**: 직관적인 인지를 위해 `Filled` 스타일 대신 `Outline` 스타일(`rectangle-outline`, `circle-outline`) 아이콘 적용.

## 2026-02-04: 도형 도구 명칭 및 UI 개선 (User Feedback 반영)
- **명칭 변경**: '가리기 도구'를 사용자 직관성을 위해 '**도형도구**'로 변경.
- **레이아웃 수정**: `Space` 컴포넌트의 잘못된 속성(`vertical` -> `direction="vertical"`)을 바로잡아 패널 내 요소들이 가로 너비를 가득 채우도록 수정.
- **아이콘 시인성 개선**: 
  - 사각형/원형 아이콘을 기존 Outline 스타일에서 **Filled 스타일**(`mdiSquare`, `mdiCircle`)로 변경.

### 2026-02-04: 도형 도구 UI 레이블 간소화
- **결정 사항**: 도형 도구의 버튼 레이블에서 " 추가" 접미사를 제거하고 하단 설명을 삭제함.
- **이유**: 사용자가 기능을 직관적으로 이해할 수 있으므로 불필요한 텍스트를 줄여 UI를 더 깔끔하게 유지하기 위함. ("사각형 추가" -> "사각형", "원형 추가" -> "원형")
  - 아이콘 크기를 확대(1.5 -> 2.2)하고 브랜드 컬러(Blue)를 적용하여 시각적 강조.
  - 버튼 높이를 키우고(`h-20` -> `h-28`) 둥근 모서리(`rounded-2xl`)를 적용하여 더 전문적인 느낌을 제공.

## 2026-02-04: 스포이드(Eyedropper) 도구 구현 방식 선정
- **결정**: 브라우저 기본 **EyeDropper API** 활용.
- **이유**: 
  1.  **성능**: Canvas의 `getImageData`를 직접 처리하는 것보다 빠르고 정확함.
  2.  **범위**: 브라우저 창 외부나 캔버스 밖의 영역에서도 색상을 추출할 수 있어 UX가 우수함.
  3.  **간결함**: 추가적인 라이브러리 없이 표준 API로 구현 가능.
- **제약**: 일부 브라우저(Firefox 등)에서 지원되지 않을 수 있으나, 현재 타겟 사용 환경(Chrome/Edge)에서는 최적의 선택으로 판단하여 도입함. (비지원 시 alert 처리)

## 2026-02-04: 모바일 최적화 및 반응형 UI 전략 (개선)
- **일체형 폴딩(Integrated Folding) UI**:
  - **결정**: 기존의 팝업 스타일 패널 대신, 하단 툴바 바로 위에서 어코디언처럼 확장되는 구조를 채택.
  - **이유**: 툴바와 패널 사이의 시각적 분절감을 줄이고 하나의 '편집 도구 세트'로서 일체감 있는 UX를 제공하기 위함.
- **자동 폴딩 및 초기 상태 제어**:
  - **결정**: 캔버스 영역 터치 시 패널 자동 닫힘 기능 구현 및 페이지 첫 진입 시 도구 미선택 상태 유지.
  - **이유**: 캔버스 편집 영역을 최대한 확보하고, 사용자에게 불필요한 정보 노출을 최소화하여 집중도 있는 작업 환경 제공.

## 2026-02-04: 공유 및 내보내기 UX 개선
- **'공유' 탭 신설 및 다운로드 버튼 이동**:
  - **결정**: 기존에 속성 패널 하단에 항상 고정되어 있던 '이미지 다운로드' 버튼을 제거하고, 별도의 **'공유(Share)'** 탭을 신설하여 그 안으로 기능을 이동시킴.
  - **이유**: 
    1.  **작업 흐름 분리**: '편집(Editing)'과 '내보내기(Exporting)' 단계를 명확히 분리하여 사용자가 편집 중에는 도구 속성에만 집중할 수 있도록 함.
    2.  **확장성**: 추후 SNS 공유, 링크 복사 등 다양한 내보내기 옵션을 추가할 공간을 미리 확보함.
- **헤더 버전 정보 제거**:
  - **결정**: 상단 헤더에 표시되던 `v1.0.0` 텍스트를 제거함.
  - **이유**: 사용자에게 불필요한 정보를 최소화하여 더욱 심플하고 몰입감 있는 UI(Minimalism)를 제공하기 위함.

## 2026-02-05: Undo/Redo (실행 취소/다시 실행) 기능 구현
- **기술**: Fabric.js의 `toJSON`과 `loadFromJSON` 메서드를 활용한 상태 기반 히스토리 스택.
- **결정**: 메모리 효율을 위해 히스토리 스택 크기를 50개로 제한.
  - **UI**: 
  - **플로팅 컨트롤**: 캔버스 우측 상단에 Undo/Redo 버튼 배치 (PC/모바일 공통 접근성).
  - **단축키**: 표준 단축키인 `Ctrl+Z` (Undo) 및 `Ctrl+Y` / `Ctrl+Shift+Z` (Redo) 지원.

## 2026-02-05: 모바일 터치 사용성 및 레이어 관리 개선
- **문제**: 모바일 환경에서 캔버스 터치 시 스크롤이 발생하여 조작이 어렵고, 작은 핸들 크기로 인해 선택이 불편함. 또한 객체 선택 시 패널이 화면을 가리는 문제 발생.
- **해결**:
    1.  **Touch Action 제어**: 캔버스 컨테이너에 `style={{ touchAction: 'none' }}`을 적용하여 브라우저 기본 스크롤 동작 차단.
    2.  **Fabric.js 핸들 및 선택 영역 최적화**:
        - `cornerSize: 12`: 핸들 시인성 확보.
              - `padding: 20`: 객체 주변 터치 영역(Hit Area)을 대폭 확대하여 선택 용이성 개선.
              - `targetFindTolerance: 15`: 터치 정밀도가 낮은 모바일 환경을 고려하여 선택 허용 오차 범위 확대.
              - `uniformScaling: false`: 대각선 핸들 조작 시 비율 고정 없이 가로/세로를 자유롭게 변형 가능하도록 설정.
              3.  **패널 자동 열림 조건 수정**: `window.innerWidth >= 768` (태블릿/PC)일 때만 객체 선택 시 패널이 자동으로 열리도록 제한.
              4.  **편집 시 패널 닫힘**: 모바일에서 캔버스 터치(`mouse:down`) 시 열려있던 패널을 강제로 닫아 편집 화면 확보.      5.  **선택 해제 로직 보강**: 빈 공간 터치(`selection:cleared`) 시 선택 상태(`activeObject`, `isTextSelected` 등)를 즉시 초기화하여 UI 동기화.
    - **레이어 관리**:
      - **용어 변경**: 사용자 혼란 방지를 위해 '배경'을 '**이미지**'로 변경.
      - **패널 명칭 통일**: 툴바 아이콘 명칭과 일치하도록 속성 패널의 제목을 '내보내기'에서 '**공유**'로 변경.
  - **기능 구현**: Fabric.js v6 API(`bringObjectToFront` 등)를 활용하여 레이어 순서 변경 기능 및 UI 구현.

## 2026-02-05: UX 개선 - 편집 도구 활성화 조건 강화- **문제**: 배경 이미지가 없는 상태에서 텍스트나 도형을 추가하면 캔버스가 보이지 않아 사용자가 혼란스러울 수 있음.
- **결정**: 배경 이미지가 업로드되기 전(`!hasBackground`)에는 **모든 편집 도구(텍스트, 도형, 브러쉬, 공유)를 비활성화(Disabled)** 처리함.
- **효과**: 사용자가 "이미지 업로드"라는 첫 단계를 명확히 인지하고 순차적으로 작업을 진행하도록 유도.

## 2026-02-07: 편집 모드 이원화 및 UI/UX 고도화
- **편집 모드 분리 (Base vs Meme)**:
  - **Base 모드**: 배경 이미지 설정, 도형(가리기용), 브러쉬 등 밈의 '바탕'을 만드는 도구들로 구성.
  - **Meme 모드**: 텍스트 추가 및 최종 결과물 공유 등 실제 '밈'을 완성하는 도구들로 구성.
  - **도입 배경**: 모든 도구가 한꺼번에 노출될 경우의 복잡도를 낮추고, 텍스트 편집 단계에서 배경이나 도형이 실수로 조작되는 것을 방지하기 위함.
- **레이어 잠금(Layer Locking) 로직**:
  - Meme 모드 진입 시 텍스트(`fabric.IText`)를 제외한 모든 객체의 `selectable` 및 `evented` 속성을 `false`로 설정하여 편집을 제한함.
- **UI 일관성 개선**:
  - 속성 패널 상단에 `ModeBadge`를 추가하여 사용자가 현재 어떤 단계에 있는지 명확히 인지하도록 개선.
  - 모바일 하단 UI에서도 모드 전환이 원활하도록 `MemeToolbar`와 `MemePropertyPanel`의 Props 전달 방식 수정.
- **객체 조작성 향상**:
  - `uniformScaling: false`를 적용하여 모든 객체(텍스트, 도형 등)의 가로/세로 비율을 자유롭게 조절할 수 있도록 변경.
