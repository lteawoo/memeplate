# 결정 로그 (Decision Log)

## [2026-02-14] 백엔드 분리 전략 채택: `Fastify + TypeScript + Zod` 스캐폴딩 우선
- **결정**: 기존 React 프론트 구조를 유지하면서 `server/` 독립 패키지로 BFF(API 서버) 골격을 먼저 도입하고, 인증/템플릿 도메인을 모듈 단위로 분리함.
- **이유**:
  1. **단계적 전환 용이성**: 프론트 전체를 재작성하지 않고 API 경유 방식으로 점진 마이그레이션 가능.
  2. **속도와 구조의 균형**: Nest 대비 보일러플레이트가 적어 MVP 속도가 빠르고, Express 대비 타입/검증 구조를 일찍 강제할 수 있음.
  3. **교체 가능성 확보**: `TemplateRepository` 인터페이스를 선행해 Supabase 의존을 인프라 레이어로 격리함.
- **구현 요약**:
  - `server/src/modules/{auth,templates,health}` 모듈 구조 생성.
  - `zod` 기반 요청 스키마(`CreateTemplateSchema`, `UpdateTemplateSchema`) 추가.
  - 루트 스크립트에 API 실행/빌드 진입점(`dev:api`, `build:api`) 연결.
  - 인증/템플릿 엔드포인트는 placeholder로 열어두고, 실제 구현은 후속 이슈로 분리.

## [2026-02-14] 텍스트 외곽선 단위를 `px`에서 `강도`로 전환하고 폰트 비례 렌더 적용
- **결정**: 텍스트 레이어의 `strokeWidth` 입력 의미를 고정 px가 아닌 상대 강도 값으로 해석하고, 실제 렌더 선 두께는 최종 폰트 크기에 비례해 계산함.
- **이유**:
  1. **가독성 문제 해소**: 작은 글자에서 `1px` 고정 외곽선이 상대적으로 과도하게 두껍게 보이는 문제를 완화.
  2. **사용자 기대 정합성**: UI의 단위 노출을 `px`에서 제거해 “절대 픽셀” 오해를 방지.
  3. **일관성 확보**: 텍스트 크기 변화에 따라 외곽선도 자연스럽게 비례해 커지고 작아지도록 유지.
- **구현 요약**:
  - `MemePropertyPanel.tsx`: `외곽선 두께 (px)`를 `외곽선 강도`로 변경, 입력 범위/슬라이더를 `0~10`으로 조정.
  - `Textbox.ts`: `ctx.lineWidth`를 `strokeIntensity * finalFontSize * 계수` 기반으로 계산하고 최소/최대 값을 clamp 처리.

## [2026-02-13] 레이어 텍스트 편집 2단 레이아웃 적용(입력폭 확장)
- **결정**: 레이어 리스트의 텍스트 레이어 아이템을 1단 혼합형에서 2단 구조로 변경해, 텍스트 입력칸을 하단 전폭으로 배치함.
- **이유**:
  1. **편집성 개선**: 액션 버튼/컬러피커와 입력칸이 한 줄에 공존해 입력 영역이 과도하게 좁았음.
  2. **가독성 향상**: 상단(메타/액션)과 하단(텍스트 입력) 역할을 분리해 레이어 카드의 정보 밀도를 안정화함.
- **구현 요약**:
  - `MemePropertyPanel.tsx` 레이어 아이템에서 텍스트 입력을 하단 `w-full` 입력필드로 분리.
  - 상단에는 `텍스트 레이어` 라벨과 기존 액션(색상/상세/삭제)을 유지.
  - 입력 필드에 `onClick`/`onKeyDown` 전파 차단을 유지해 편집 중 이벤트 간섭 최소화.

## [2026-02-13] 툴바 컴팩트화 1차 적용 (`이미지/편집/공유`)
- **결정**: 툴바의 높이/패딩/그룹 여백을 1차로 축소해 동일 정보량 대비 세로 점유를 줄임.
- **이유**:
  1. **가시 영역 확보**: 특히 모바일/좁은 화면에서 툴바가 차지하는 높이를 줄여 캔버스/패널 가시 영역을 늘림.
  2. **밀도 개선**: 기능 구조를 바꾸지 않고도 섹션을 더 컴팩트하게 정리 가능.
- **구현 요약**:
  - `MemeToolbar.tsx`의 컨테이너 높이 `h-24 -> h-20`.
  - 버튼 패딩 `py-3/4 -> py-2`, 아이콘 크기 `0.9/1.1 -> 0.85/1`.
  - 그룹 래퍼 `p-1.5/rounded-2xl -> p-1/rounded-xl`.

## [2026-02-13] 회전 핸들(MTR) 히트 테스트 좌표 보정
- **결정**: 회전 핸들의 클릭 판정 좌표 계산에 `scale`을 동일하게 적용해 렌더 위치와 히트 영역을 일치시킴.
- **이유**:
  1. **정합성**: 렌더링은 `-halfH - (30 * scale)`인데 히트 테스트는 `-halfH - 30`을 사용해 스케일 환경에서 불일치가 발생함.
  2. **사용성**: 핸들이 보여도 클릭/드래그가 먹지 않는 체감을 제거해야 함.
- **구현 요약**:
  - `Canvas.ts`의 `findControl`에서 `mtr` 좌표를 `-halfH - (30 * scale)`로 수정.

## [2026-02-13] 리사이즈 UX 표준화: 코너 자유변형(단축키 modifier 스펙 제외)
- **결정**: 코너 핸들의 기본 동작을 비율 고정에서 자유변형으로 전환하고, 엣지 핸들의 단일 축 리사이즈 동작을 유지함. `Shift`/`Alt(Option)` modifier 리사이즈는 현 스펙에서 제외함.
- **이유**:
  1. **사용자 기대 정합성**: 일반 그래픽 편집기 UX와 동일한 기본 규칙(코너 드래그 시 가로/세로 동시 자유 조절)을 제공.
  2. **스코프 명확화**: 단축키 기반 조작까지 포함하면 테스트/호환 범위가 확장되어 이번 라운드 목적(기본 조작 직관성 개선)에 비해 과해짐.
  3. **회귀 최소화**: 기존 회전/고정점 계산 구조를 유지하면서 기본 리사이즈 동작만 정리해 안정적으로 반영.
- **구현 요약**:
  - `Canvas.ts` 리사이즈 계산에서 코너 강제 uniform 로직 제거.
  - 핸들 기준 고정점(anchor) 계산은 기존 구조를 유지해 회전 객체에서도 일관 동작.
  - `Shift`/`Alt(Option)` 기반 리사이즈 분기는 제거해 스펙 외 동작으로 처리.

## [2026-02-13] 줌 모드 제거 및 최대 px 상한 기반 단일 자동 스케일로 단순화
- **결정**: `Fit/100%` 토글을 제거하고, 뷰포트 맞춤 + 최대 표시 변 길이(`800px`) 상한을 동시에 적용하는 단일 자동 비율 스케일로 통합함.
- **이유**:
  1. **UI 단순화**: 이중 모드 전환(`Fit`/`100%`) 없이 한 가지 표시 정책으로 학습 비용을 낮춤.
  2. **표시 안정성**: 작은 원본은 적절히 확대하고, 과도한 확대는 `800px` 상한으로 제한해 편집 가독성을 유지.
  3. **일관성**: 원본 크기와 무관하게 항상 비율 유지(contain) 정책으로 확대/축소 동작을 통일.
- **구현 요약**:
  - `MemeEditor.tsx`: `zoomMode` 상태, `Fit/100%` 버튼, 관련 effect 제거.
  - `MemeCanvas.tsx`: `displayScale = min(viewportScale, 800 / max(intrinsicWidth, intrinsicHeight))`로 계산.
  - 캔버스 CSS 표시 크기는 `Math.floor` 기반으로 유지하여 클리핑 리스크를 계속 억제.

## [2026-02-13] Fit 비클리핑 보장 강화를 위한 floor 계산 적용
- **결정**: `fit` 모드에서 캔버스 CSS 표시 크기를 `round` 대신 `floor`로 계산함.
- **이유**:
  1. **가장자리 안정성**: 반올림으로 인해 1px 초과되어 가로/세로가 잘리는 케이스를 방지.
  2. **사용자 기대 충족**: `Fit`의 의미를 “절대 안 잘림(contain)”으로 일관되게 유지.
- **구현 요약**:
  - `MemeCanvas.tsx`에서 `zoomMode === 'fit'`일 때 `displayWidth/Height`를 `Math.floor(...)`로 계산.

## [2026-02-13] 대형 이미지에서 Fit 미동작 체감 수정 (레이아웃 폭 고정)
- **결정**: 편집 레이아웃의 flex 컨테이너에 `min-w-0`을 적용해 대형 캔버스가 부모 폭을 확장시키지 못하도록 수정함.
- **이유**:
  1. **원인 제거**: `100%` 상태의 큰 캔버스가 컨테이너 폭을 밀어 `fitScale`이 사실상 1로 유지되는 케이스가 있었음.
  2. **동작 보장**: `100% -> Fit` 전환 시 실제 뷰포트 폭 기준으로 축소가 즉시 반영되도록 보장.
- **구현 요약**:
  - `EditorLayout.tsx`, `MemeEditor.tsx`, `MemeCanvas.tsx`의 주요 flex 래퍼에 `min-w-0` 추가.

## [2026-02-13] 이미지 변경 시 Fit 자동 복귀 처리
- **결정**: 배경 이미지 교체로 작업영역 크기(`workspaceSize`)가 바뀌면 줌 모드를 자동으로 `fit`으로 전환함.
- **이유**:
  1. **오동작 체감 방지**: 이전 이미지에서 `100%`를 보고 있던 상태가 새 대형 이미지에 그대로 적용되면 `fit`이 안 되는 것처럼 보임.
  2. **초기 가시성 보장**: 새 이미지는 항상 전체 구도를 먼저 보게 하여 편집 시작점을 안정화.
- **구현 요약**:
  - `MemeEditor.tsx`에서 `workspaceSize`(`width`,`height`) 변경을 감지해 `setZoomMode('fit')` 실행.

## [2026-02-13] 줌 퍼센트 표시 제거 및 Fit 순수 화면맞춤 복원
- **결정**: 상단 줌 퍼센트 텍스트를 제거하고, `Fit` 모드에서 확대 상한 없이 순수 화면맞춤 비율을 사용함.
- **이유**:
  1. **UI 단순화**: 퍼센트 숫자 노출을 줄여 상단 컨트롤 밀도를 낮춤.
  2. **직관성**: `Fit` 선택 시 캔버스가 뷰포트를 최대한 채우는 기대 동작을 일관되게 보장.
- **구현 요약**:
  - `MemeEditor.tsx`: `onZoomPercentChange` 및 퍼센트 텍스트 제거.
  - `MemeCanvas.tsx`: `fitScale`의 가변 상한 로직 제거 후 `min(viewport/image)` 순수 계산 적용.

## [2026-02-13] 줌 UI 복원: Fit/100% 재도입 및 기본 Fit 회귀
- **결정**: Auto Fit-only UI를 되돌리고 `Fit`/`100%` 버튼과 퍼센트 표시를 재도입함. 기본 표시 모드는 `Fit`으로 설정.
- **이유**:
  1. **명시성**: 사용자에게 현재 표시 기준(화면 맞춤/원본)을 명확히 제공.
  2. **조작 단순성**: 최소한의 줌 선택지만 유지해 UI 복잡도는 낮추고 예측 가능성은 확보.
- **구현 요약**:
  - `MemeEditor.tsx`: `zoomMode('fit'|'actual')`, 퍼센트 상태, `Ctrl/Cmd+0` 복귀 핸들러 복원.
  - `MemeCanvas.tsx`: `zoomMode`에 따라 `displayScale`을 `fitScale` 또는 `1`로 적용하고 퍼센트 콜백 재연결.

## [2026-02-13] 줌 UI 제거 및 Auto Fit 전용 정책으로 단순화
- **결정**: 상단의 줌 UI(증감 버튼, 퍼센트 입력)를 제거하고, 화면 표시는 Auto Fit만 사용하도록 정리함.
- **이유**:
  1. **UI 밀도 완화**: 상단 컨트롤의 혼잡도를 줄여 핵심 편집 동선(Undo/Redo, 도구 선택)에 집중.
  2. **일관성**: 수동 줌/자동 줌 상태 전환 복잡도를 줄이고 기본 표시 정책을 단일화.
- **구현 요약**:
  - `MemeEditor.tsx`에서 줌 상태/컨트롤 및 관련 핸들러 제거.
  - `MemeCanvas.tsx`에서 `displayScale`을 Auto Fit 단일 계산으로 고정하고 휠 줌 콜백 제거.

## [2026-02-13] Auto Fit 가변 상한(비율 밴드) 적용
- **결정**: Auto Fit 스케일 상한을 고정값 대신 `rawFitScale`(뷰포트/원본 비율) 밴드에 따라 가변 적용함.
- **이유**:
  1. **대형 원본 보호**: 원본이 큰 경우(`rawFitScale <= 1`)에는 확대를 허용하지 않아 과확대 리스크를 제거.
  2. **소형 원본 가독성**: 원본이 작은 경우에만 제한적으로 자동 확대해 초기 가시성을 개선.
- **구현 요약**:
  - `MemeCanvas.tsx`에서 `rawFitScale` 계산 후 밴드별 상한 적용.
  - 밴드: `1.0~1.25 -> 1.1`, `1.25~1.75 -> 1.25`, `1.75+ -> 1.4`.

## [2026-02-13] Auto Fit 과확대 방지 상한 도입
- **결정**: Auto Fit 계산 결과가 100%를 초과하지 않도록 최대 스케일 상한(`1.0`)을 적용함.
- **이유**:
  1. **예측 가능성**: 작은 원본 이미지가 뷰포트에 맞춰 과도하게 커지는 체감을 줄임.
  2. **안정성**: 기본 표시 모드에서 의도치 않은 확대로 인한 편집 오차를 완화함.
- **구현 요약**:
  - `MemeCanvas.tsx`의 `fitScale` 계산에 `AUTO_FIT_MAX_SCALE = 1` 상한 추가.

## [2026-02-13] 줌 UX 고도화: fit/manual 모델 + 연속 줌 컨트롤 도입
- **결정**: 기존 `Fit/100%` 이진 토글을 `fit/manual` 모델로 확장하고, `- / + / 퍼센트 입력` + `Ctrl/Cmd + Wheel` 연속 줌을 도입함.
- **이유**:
  1. **유려한 조작성**: 고정 모드 전환만으로는 미세 조정이 어려워 편집 흐름이 끊기므로 연속 줌이 필요함.
  2. **예측 가능성**: 현재 배율을 숫자로 직접 제어할 수 있어 작업자가 결과를 빠르게 맞출 수 있음.
  3. **일관성 유지**: `Ctrl/Cmd + 0`은 기존처럼 `Fit` 복귀를 유지해 학습 비용을 낮춤.
- **구현 요약**:
  - `MemeEditor.tsx`: `zoomMode`를 `fit/manual`로 변경하고 `InputNumber` 기반 줌 퍼센트 입력 및 `- / +` 버튼 추가.
  - `MemeCanvas.tsx`: `zoomPercent` prop 기반 수동 표시 스케일 계산, `Ctrl/Cmd + Wheel` 이벤트를 상위 콜백으로 전달.
  - 캔버스 표시 크기 전환에 `200ms` 전환 효과를 부여해 배율 변경 체감을 완화.

## [2026-02-13] 텍스트 선명도 개선을 위한 렌더 스케일(Backing Store) 도입
- **결정**: 캔버스 CSS 표시 배율이 100%를 넘을 때도 텍스트가 흐려지지 않도록, 표시 배율과 `devicePixelRatio`를 반영한 렌더 스케일을 캔버스 백킹 스토어에 적용함.
- **이유**:
  1. **품질 유지**: CSS 확대만으로는 비트맵이 늘어나 텍스트가 흐려지므로, 고해상도 재렌더가 필요함.
  2. **일관성**: Fit/100% 전환 시에도 텍스트 품질 편차를 줄여 사용자 체감 품질을 안정화함.
- **구현 요약**:
  - `Canvas.ts`: `renderScale`, `setRenderScale`, backing store 동기화(`syncBackingStoreSize`) 추가.
  - `render()`에서 `setTransform(renderScale, ...)` 적용해 논리 좌표계는 유지하고 픽셀 밀도만 확장.
  - `MemeCanvas.tsx`에서 `displayScale`과 `devicePixelRatio`를 조합해 `canvasInstance.setRenderScale(...)` 호출.

## [2026-02-13] 텍스트 편집 오버레이 스타일 동기화 강화
- **결정**: 더블클릭 편집 textarea 스타일을 텍스트 객체의 실제 속성(`textAlign`, `lineHeight`, `fontFamily`, `fontWeight`, `fontStyle`)과 동기화함.
- **이유**: 편집 중 시각과 최종 캔버스 렌더가 다르면 품질 저하로 오해되기 쉬우므로, WYSIWYG 정합성을 우선함.

## [2026-02-13] lint 경고 0 기준 복구를 위한 `useMemeEditor` 타입/훅 정리
- **결정**: `useMemeEditor.ts`에서 경고를 임시 비활성화하지 않고, 훅 의존성과 타입 정의를 보강해 `eslint --max-warnings 0` 기준을 직접 만족하도록 수정함.
- **이유**:
  1. **검증 파이프라인 안정화**: 현재 정책상 warning도 실패이므로 lint를 즉시 통과 가능한 상태로 유지해야 함.
  2. **유지보수성**: `any` 캐스팅과 미사용 변수는 기능 확장 시 회귀 리스크를 키우므로 조기 정리 필요.
- **구현 요약**:
  - `undo`/`redo`를 `useCallback`으로 래핑하고 키보드 effect 의존성 배열을 정합하게 조정.
  - 더블클릭/업로드 이벤트 파라미터 타입 정의를 추가해 `any` 제거.
  - 불필요한 `as any` 캐스팅과 미사용 catch 변수를 정리.

## [2026-02-13] 캔버스 표시 정책 개선: Fit 기본 + 100% 토글 도입
- **결정**: 캔버스 표시 모드를 `Fit`(기본)과 `100%`(원본 1:1)로 분리하고, 상단 컨트롤에 토글 버튼/퍼센트 표시를 배치함.
- **이유**:
  1. **예측 가능성**: 사용자가 현재 표시 기준(화면 맞춤 vs 원본 크기)을 명확히 인지할 수 있어 혼란을 줄임.
  2. **작업 효율**: 기본은 `Fit`으로 편집 가시성을 확보하고, 필요할 때만 `100%`로 정밀 확인 가능.
  3. **흐름 유지**: Undo/Redo 인접 영역에 배치해 기존 편집 플로우를 해치지 않음.
- **구현 요약**:
  - `MemeCanvas.tsx`: `Fit`/`100%` 토글, 퍼센트 표시, `Ctrl/Cmd + 0`(Fit 복귀) 단축키 추가.
  - 컨테이너 크기와 원본 크기를 기반으로 표시 스케일을 계산하여 비율을 유지함.

## [2026-02-13] 업로드 이미지 원본 해상도 기준 캔버스 논리 크기 반영
- **결정**: 배경 업로드 시 고정 기준값(`targetBaseSize=1200`) 정규화를 제거하고, `naturalWidth/Height`를 캔버스 논리 크기로 사용함.
- **이유**:
  1. **원본 존중**: 업로드 직후 이미지가 의도보다 과도하게 확대/축소되는 체감을 줄임.
  2. **일관성**: 편집 좌표계와 내보내기 해상도가 원본 기준으로 정렬되어 결과 예측성이 좋아짐.
- **구현 요약**:
  - `useMemeEditor.ts`에서 `setBackgroundImage` 로직을 원본 해상도 기반으로 수정.
  - 배경 객체 스케일은 `1`로 설정하고, 표시 스케일은 뷰 레이어(`MemeCanvas`)에서만 제어.

## [2026-02-13] 화면 배율 독립적 조절점(Constant Size Handles) 구현
- **결정**: 캔버스의 논리적 크기와 상관없이 화면상의 물리적 크기를 일정하게 유지하는 조절점 렌더링 로직을 도입함.
- **이유**:
  1. **조작성(Accessibility)**: 모바일 등 작은 화면에서 캔버스가 축소될 경우 조절점이 너무 작아져 터치/클릭이 불가능해지는 문제 해결.
  2. **시각적 일관성**: 선 두께와 핸들 크기를 일정하게 유지하여 어떤 기기에서도 동일한 UI 품질 제공.
- **구현 방식**: 
  - `getSceneScale()`을 통해 (논리 크기 / 실제 CSS 크기) 배율을 구함.
  - 조절점 렌더링(직사각형, 원, 선 두께) 시 해당 배율을 곱하여 시각적 크기를 역보정함.
  - `handleSize`에도 배율을 적용하여 터치 감지 영역을 충분히 확보함.

## [2026-02-13] 모바일 레이아웃 방식 변경 (Overlay -> Vertical Stack)
- **결정**: 모바일 화면에서 하단 툴바와 슬라이드업 패널(Overlay)을 사용하던 기존 방식을 버리고, 캔버스-툴바-속성패널이 세로로 나열되며 전체 페이지가 스크롤되는 방식으로 변경함.
- **이유**:
  1. **사용성(Usability)**: 오버레이 패널이 열렸을 때 캔버스 영역이 가려지거나 조작이 불편했던 문제를 해결.
  2. **직관성**: 모든 편집 도구와 속성이 한 페이지 내에 나열되어 사용자가 스크롤만으로 모든 기능에 접근 가능함.
  3. **구조적 단순화**: 복잡한 애니메이션 및 고정(fixed) 위치 계산 로직을 제거하여 유지보수성 향상.
- **영향**: 모바일 전용 UI 로직의 대폭 리팩토링 및 레이아웃 컴포넌트의 유연성 확보.

## [2026-02-11] 캔버스 이벤트 핸들링 최적화 및 중복 실행 방지
- **문제**: 모바일/태블릿 환경에서 `touchstart`와 `mousedown`이 연속으로 발생하여 핸들러가 2번 실행되고, React Strict Mode 및 HMR 환경에서 `dispose` 누락으로 인해 리스너가 N배로 누적되는 현상 발생.
- **결정**: 
  1. **이벤트 정규화**: `touchstart` 이벤트 발생 시 `e.preventDefault()`를 호출하여 브라우저의 가상 `mousedown` 이벤트 발생을 차단, 정확히 1번만 실행되도록 보장함.
  2. **리스너 생명주기 관리**: 이벤트 핸들러(`handleDown`, `handleMouseMove`)를 클래스 멤버로 격상하고, `dispose()` 메서드에서 `removeEventListener`를 명시적으로 호출하여 메모리 누수 및 중복 등록을 원천 차단함.
- **이유**: 사용자의 의도치 않은 중복 클릭(더블 액션) 방지 및 개발/운영 환경에서의 안정적인 성능 확보.
- **영향**: 모바일 터치 반응성 개선 및 장시간 사용 시 메모리 점유율 안정화.

## [2026-02-10] 고정 틀(Fixed Container) 기반 텍스트 레이어 시스템 도입
- **결정**: 텍스트 레이어를 내용물(글자 수)에 따라 크기가 변하는 방식이 아닌, 사용자가 지정한 물리적 영역을 유지하는 '고정 틀' 방식으로 전환함.
- **이유**:
  1. **레이아웃 안정성**: 텍스트를 수정하거나 지워도 레이어 영역이 변하지 않아 편집 중인 레이아웃이 무너지지 않음.
  2. **디자인 제어**: 사용자가 미리 텍스트가 들어갈 영역을 정의하고 그 안에서 글자가 노는 방식을 선호함 (포토샵/피그마 방식).
- **상세 구현**:
  - **자동 줄바꿈(Word Wrap)**: 틀의 너비를 넘어가면 자동으로 다음 줄로 텍스트를 배치.
  - **상단 정렬(Top Align)**: 텍스트를 틀의 위쪽부터 채워나감 (세로 중앙 정렬 제거).
  - **리사이즈 로직 차별화**: 텍스트 레이어 리사이즈 시 `scale` 대신 `width/height`를 직접 수정하여 **글씨 크기(fontSize)를 절대적으로 유지**.

## [2026-02-10] 렌더링 시스템 최적화 (Dirty Flag & Async Support)
- **결정**: 매 프레임 캔버스를 지우고 다시 그리는 대신, 변경 사항이 있을 때만 그리도록 `needsRedraw` 플래그를 도입하고 렌더링 루프를 개선함.
- **이유**:
  1. **성능 및 배터리**: 불필요한 GPU/CPU 점유율을 낮춰 브라우저 성능 최적화.
  2. **깜빡임 제거**: 브라우저 화면 갱신 주기(V-Sync)와 캔버스 지우기 시점을 일치시켜 떨림 현상 해결.
  3. **비동기 대응**: 이미지 등 리소스가 로딩 중일 때는 로드가 완료될 때까지 루프가 지속되도록 보강하여 업로드 즉시 화면에 나타나도록 함.
- **구현**: `requestRender()` 메서드를 통해 명시적으로 렌더링을 요청하고, `renderLoop`에서 플래그 확인 후 `render()` 수행.

## [2026-02-07] 편집 모드 통합 및 도구 체계 단순화
- **결정**: 'Base/Meme' 모드 구분을 삭제하고, 모든 편집 도구를 단일 환경으로 통합함. 또한 '도형'과 '브러쉬'를 '지우개'라는 하나의 도구로 합침.
- **이유**:
  1. **단순함(Simplicity)**: 사용자가 모드를 전환해야 하는 인지적 비용을 제거하여 더 빠르고 직관적인 편집 환경 제공.
  2. **명확한 기능 분류**: '가리기'를 위한 모든 행위(도형으로 가리기, 브러쉬로 덧칠하기)를 '지우개'라는 명칭 아래 통합하여 기능의 목적을 명확히 함.
  3. **공간 효율**: 툴바 구성을 5개 핵심 도구로 정예화하여 모바일/데스크탑 모두에서 최적의 가독성 확보.
- **도구 구성**: 이미지, 텍스트, 지우개(도형/브러쉬), 레이어, 공유

## [2026-02-07] 레이어 관리 UI 독립화 및 구조 개선
- **결정**: 레이어 관리 기능을 속성 패널 내부의 하단 고정 섹션(Fixed Section)으로 완전히 분리하고, 상단 속성 영역과 시각적/구조적으로 격리함.
- **이유**:
  1. **명확한 영역 분리**: 도구별 세부 설정(속성)과 전체 레이어 구조(관리)를 별도 영역으로 나누어 인지 부하를 줄임.
  2. **사용성 최적화**: 속성 영역이 길어져도 레이어 관리 섹션은 하단에 고정되거나(Desktop) 정해진 비율을 유지하여(Mobile) 항상 접근 가능하도록 함.
- **변경 사항**:
  - `MemePropertyPanel`: `flex-col` 구조를 도입하여 상단은 속성(Scrollable), 하단은 레이어(Fixed Height 40%)로 분리.
  - `MemeEditor`: 모바일 패널 내부의 중복 스크롤을 제거하여 리팩토링된 패널 레이아웃이 정상 동작하도록 수정.

## [2026-02-07] 레이아웃 여백 통일 및 레이어 섹션 디자인 개선
- **결정**: 상단 헤더, 좌측 툴바, 속성 패널의 좌우 여백을 모두 `px-8` (32px)로 통일하고, 레이어 섹션을 더 명확하게 분리함.
- **이유**:
  1. **시각적 정렬**: 화면 전체의 좌측 라인(로고, 툴바 버튼, 패널 내용)을 일치시켜 안정감 있는 레이아웃 제공.
  2. **강력한 구분**: 레이어 관리 영역에 독립된 헤더와 그림자 효과를 추가하여 '속성 편집'과 '구조 관리'의 차이를 명확히 함.
- **변경 사항**:
  - `MemeToolbar`: 너비를 `w-32`로 확장하고 패딩을 `px-8`로 조정.
  - `MemePropertyPanel`: 모든 섹션의 패딩을 `px-8`로 통일하고 레이어 섹션 디자인 고도화.
  - `MemeEditor`: 툴바 너비 확장에 맞춰 사이드바 전체 너비를 `448px` (8-grid)로 조정.

## [2026-02-07] Vite 설정 오류 수정
- **결정**: `vite.config.ts`에서 실제로 설치되지 않은 `@vitejs/plugin-react-swc` 대신 `package.json`에 명시된 `@vitejs/plugin-react`를 사용하도록 수정함.
- **이유**: 잘못된 플러그인 참조로 인한 빌드 환경의 불일치 해결.

## [2026-02-07] 도형 속성 단순화 및 컬러피커 컴포넌트 분리
- **결정**: '도형(Shapes)' 도구에서 불투명도와 외곽선 두께 조절 기능을 제거하고, `MemePropertyPanel.tsx`에 내장되어 있던 `MemeColorPicker`를 독립 컴포넌트로 분리함.
- **이유**: 
  1. **UX 단순화**: 가리기 용도로 주로 사용되는 도형 도구의 불필요한 속성을 제거하여 사용성을 높임.
  2. **관심사 분리**: 비대해진 `MemePropertyPanel`의 코드 가독성을 높이고, 컬러피커의 재사용성을 확보함.
- **변경 범위**:
  - `src/components/editor/MemeColorPicker.tsx` (신규 생성)
  - `src/components/editor/MemePropertyPanel.tsx` (리팩토링)

## [2026-02-07] 8px 그리드 시스템 엄격 적용 (Strict 8px Grid)
- **결정**: 프로젝트 전반에 남아있던 4px 단위(홀수 배수 제외) 및 12px(3) 등의 비표준 간격을 제거하고, 8px(2), 16px(4), 24px(6) 등 짝수 배수 단위로 통일함.
- **이유**: `gap-1.5` (6px), `py-3` (12px) 등은 8px 그리드 시스템의 리듬감을 저해하고 디자인 일관성을 떨어뜨림. 엄격한 규칙 적용을 통해 유지보수성과 시각적 완성도를 높임.
- **변경 범위**:
  - `MemeToolbar`: 도구 버튼 간격(`gap-1.5` -> `gap-2`) 및 패딩(`py-3` -> `py-4`) 수정.
  - `MemePropertyPanel`: 섹션 간 여백(`mb-3` -> `mb-4`) 및 요소 간격(`gap-3` -> `gap-4`) 수정.
  - `MainHeader`: 로고와 타이틀 간격(`gap-3` -> `gap-4`) 수정.
- **2026-02-07 레이아웃 밀도 최적화**:
  - **결정**: 사용자 피드백에 따라 과도하게 넓은 여백을 전방위적으로 축소.
  - **변경 사항**: 
    - `HomePage`, `MemeCanvas` 패딩 축소 (`p-12` -> `p-8`).
    - `MemeToolbar` 너비 및 간격 축소 (`w-32` -> `w-28`, `gap-8` -> `gap-6`).
    - `MemeEditor` 사이드바 너비 축소 (`448px` -> `400px`) 및 캔버스 가용 영역 확대.
    - `MainHeader` 및 `MemePropertyPanel` 수평 패딩 축소 (`px-8` -> `px-6`).

## [2026-02-07] 모바일 UI/UX 고도화 및 반응형 최적화
- **결정**: 모바일 하단 툴바에 가로 스크롤을 도입하고, 모드 전환 스위처의 너비를 축소하며, Empty State UI 크기를 유동적으로 조절함.
- **이유**:
  1. **가용성 확보**: 모바일의 좁은 너비에서 모든 도구 버튼을 노출하기 위해 스크롤 도입이 필수적임.
  2. **가독성 및 편집성**: 속성 패널이 열렸을 때 캔버스 영역이 극도로 좁아지는 문제를 해결하기 위해 Empty State의 수직 점유율을 낮춤.
  3. **터치 UX**: 툴바 아이템 간격을 8px 그리드 내에서 최적화하여 오동작 방지.

## [2026-02-09] TypeScript 타입 안전성 강화 및 의존성 최적화
- **결정**: `src/types/global.d.ts`에서 `fabric` 모듈을 확장하여 `FabricObject`에 `id`, `name` 속성을 추가하고, `@types/node`를 설치함.
- **이유**: 
  1. **타입 안전성**: Fabric.js의 기본 객체 타입에는 없는 사용자 정의 속성(`id`, `name`)을 안전하게 사용하기 위함.
  2. **환경 설정 정상화**: `tsconfig.node.json`에서 발생하는 `node` 타입 미지정 오류를 해결하여 전체 빌드 파이프라인의 안정성을 확보함.

## [2026-02-09] 레이어 관리 UI 간소화 및 세로형 조절 버튼 도입
- **결정**: 레이어 리스트 아이템의 좌측에 세로형 위/아래(`mdiChevronUp`, `mdiChevronDown`) 버튼을 배치하여 순서 조절 기능을 직관적으로 개선함.
- **이유**: 기존의 4단계(맨앞/앞/뒤/맨뒤) 버튼은 공간을 많이 차지하고 복잡해 보였으나, 단순 위/아래 버튼만으로도 충분한 제어가 가능하며 UI를 더 깔끔하게 유지할 수 있음.

## [2026-02-09] 캔버스 내부 작업 영역(Internal Workspace) 및 경계 제한 도입
- **결정**: 실제 이미지 크기보다 상하좌우 60px 큰 캔버스를 생성하고(`CANVAS_MARGIN`), 객체가 이미지 영역을 벗어나지 못하도록 경계 제한 로직을 추가함.
- **이유**: 
  1. **선택 박스 시인성**: 객체가 이미지 가장자리에 있을 때 선택 테두리와 조절점(Corners)이 캔버스 밖으로 잘리는 문제를 해결하기 위함.
  2. **조작 안정성**: 객체가 작업 영역 밖으로 완전히 사라지는 것을 방지하여 사용자 실수를 최소화함.
  3. **내보내기 최적화**: 다운로드 및 클립보드 복사 시에는 `CANVAS_MARGIN`을 제외한 실제 작업 영역만 크롭(Crop)하여 저장되도록 구현.

## [2026-02-09] 모바일 UI 통합 및 슬림 바(Slim Bar) 제거
- **결정**: 모바일에서 객체 선택 시 나타나던 120px 높이의 '슬림 바'를 제거하고, PC와 동일하게 45vh 높이의 전체 속성 패널을 사용하도록 통합함.
- **이유**: 
  1. **기능성 확보**: 슬림 바에서는 레이어 리스트에 접근하기 어려워 다시 도구 버튼을 눌러야 하는 번거로움이 있었음.
  2. **일관성**: 기기별로 다른 UI 구조를 유지하는 대신, 하나의 패널 내에서 모든 편집과 레이어 관리가 가능하도록 하여 학습 비용을 줄임.
  3. **편집성**: 45vh 높이에서도 캔버스 작업 영역이 충분히 확보되며, 레이어 리스트를 보면서 동시에 속성을 편집하는 것이 더 효율적임.

## [2026-02-09] 배경 이미지 처리 방식 변경 (Background to Layer)
- **결정**: Fabric.js의 `backgroundImage` 속성 대신, 일반 객체(`fabric.Image`)로 생성하여 가장 하위 레이어(index 0)에 배치하고 `selectable: false` 처리함.
- **이유**: 캔버스 확장(`CANVAS_MARGIN`) 시 `backgroundImage`는 중앙 배치가 어렵고 여백 제어가 까다롭지만, 일반 객체로 처리하면 좌표(`left`, `top`) 제어가 용이하고 레이어 시스템 내에서 일관되게 관리할 수 있음.


## [2026-02-07] 툴바 UI 단순화 및 디자인 일관성 강화
- **결정**: `MemeToolbar`의 도구 버튼 디자인을 상단 'Base/Meme' 스위처와 동일한 스타일로 통일하고, 별도의 포인트 인디케이터(바 형태) 제거.
- **이유**: 
  1. **시각적 일관성**: 서로 다른 스타일의 버튼들이 혼재되어 발생하는 시각적 노이즈 제거. 
  2. **미니멀리즘**: 버튼 자체의 배경색 변화와 링(Ring) 효과만으로도 활성 상태를 충분히 인지 가능함.
  3. **공간 효율**: 불필요한 인디케이터 바를 제거하여 레이아웃을 더 깔끔하게 유지.
- **변경 사항**:
  - `SidebarItem`의 패딩 및 간격 조정 (8px 그리드 준수).
  - 인디케이터 바 제거 및 활성 상태 스타일 수정 (`bg-white` + `shadow-sm` + `ring-1 ring-black/5`).
  - 툴바 내부 구분선(Divider) 제거 및 여백 조정.

## [2026-02-07] UI/UX 정교화 및 8px 그리드 시스템 강화 (이전)
- **결정**: `SidebarItem`의 `aspect-square` 속성을 제거하고, 모드 스위처와 유사한 직사각형(Rectangular) 스타일로 변경.
- **이유**: 기존 정사각형 버튼은 툴바 섹션의 크기에 비해 작아 보이고, 상단 탭(Base/Meme)과의 시각적 일관성이 떨어짐. 직사각형 구조를 통해 텍스트와 아이콘의 시각적 무게를 조절.
- **인디케이터**: 단순 배경색 변경만으로는 활성 상태 인지가 부족할 수 있어, 데스크탑은 우측 세로 바, 모바일은 하단 가로 바 형태의 포인트 인디케이터를 추가함. (이후 단순화 과정을 통해 제거됨)

### 1. MemeToolbar 버튼 및 인디케이터 개선
- **결정**: `SidebarItem`의 `aspect-square` 속성을 제거하고, 모드 스위처와 유사한 직사각형(Rectangular) 스타일로 변경.
- **이유**: 기존 정사각형 버튼은 툴바 섹션의 크기에 비해 작아 보이고, 상단 탭(Base/Meme)과의 시각적 일관성이 떨어짐. 직사각형 구조를 통해 텍스트와 아이콘의 시각적 무게를 조절.
- **인디케이터**: 단순 배경색 변경만으로는 활성 상태 인지가 부족할 수 있어, 데스크탑은 우측 세로 바, 모바일은 하단 가로 바 형태의 포인트 인디케이터를 추가함.

### 2. 8px 그리드 시스템 엄격 적용
- **결정**: 모든 Padding, Gap, Width 값을 8px의 배수로 재조정 (예: `420px` -> `416px`, `gap-6` -> `gap-8`).
- **이유**: 디자인 가이드(master_rule_v2.md) 준수 및 UI의 리듬감과 안정성 확보.

## 2026-02-07 이전 기록...

- **결정**: 툴바의 모든 요소를 8px 그리드 시스템에 맞춰 재설계하고, 도구 버튼의 스케일을 모드 스위처와 통일함.
- **이유**: 기존 버튼이 주변 섹션에 비해 작아 시각적 불균형이 있었음. 인디케이터 방식을 수직 바에서 '면(Soft Background) + 선(Ring) + 점(Mobile Dot)' 조합으로 변경하여 정보 전달력과 미적 완성도를 동시에 높임.
- **영향**: 데스크탑/모바일 전반의 사용성 및 시각적 완성도 대폭 향상.

- **결정**: 활성화된 도구 버튼의 스타일을 `bg-blue-600` (반전)에서 `bg-white` + `text-blue-600` + `shadow` + `indicator` 방식으로 변경.
- **이유**: 기존의 강한 파란색 블록 스타일은 가독성을 저해하고 전체적인 UI 톤(Light/Clean)과 충돌함. 현대적인 에디터 UI 컨벤션에 맞춰 보다 부드럽고 명확한 활성화 표시 방식을 채택함.
- **영향**: `MemeToolbar` 내의 모든 도구 버튼 및 상단 모드 전환 탭에 적용되어 일관성 향상.


## 2026-02-04: 기술 스택 선정 및 초기 설정
- **프레임워크**: React 19 (Vite) - 최신 React 기능을 활용한 빠른 개발.
- **UI 라이브러리**: Ant Design (antd) 6.x - 최신 디자인 시스템과 컴포넌트 활용.
- **스타일링**: Tailwind CSS 4.x - Ant Design의 세부 간격 보정 및 유틸리티 기반 스타일링.
- **캔버스 라이브러리**: Fabric.js 7.x - ES Module 기반의 최신 API 활용 (Promise 기반 이미지 로딩 등).

## 2026-02-04: PostCSS 및 Tailwind CSS v4 설정 수정
- **이유**: Tailwind CSS v4에서는 `tailwindcss` 직접 호출 방식이 아닌 `@tailwindcss/postcss` 패키지를 별도로 사용해야 함.
- **조치**: `@tailwindcss/postcss` 설치 및 `postcss.config.js` 플러그인 설정 업데이트.

## 2026-02-04: UI/UX 디자인 고도화
- **레이아웃**: Ant Design의 `Tabs`를 사용하여 배경과 텍스트 설정을 분리, 복잡한 편집 도구를 체계화함.
- **사용성 개선**: `Upload.Dragger`를 통한 직관적인 이미지 업로드, 배경 없을 시 Empty state 가이드 제공.
- **단축키 도입**: 사용자 편의를 위해 `Delete`, `Backspace` 키를 통한 객체 삭제 이벤트 리스너 구현.
- **브랜딩**: `theme.useToken()`을 활용하여 Ant Design의 디자인 토큰(색상, 테두리 반경 등)을 앱 전반에 일관되게 적용.

## 2026-02-04: 반응형 UI 및 디자인 시스템 고도화
- **반응형 캔버스**: 브라우저 창 크기에 따라 캔버스 크기가 동적으로 조절되도록 `ResizeObserver` 패턴 적용 (여백 64px 유지).
- **Empty State 개선**: 이미지가 없을 때의 시각적 불일치를 해결하기 위해 캔버스 영역을 전용 업로드 드롭존으로 대체.
- **디자인 규칙 준수**: `GEMINI.md`의 디자인 규칙(8px 그리드, 큰 여백, 200~300ms 애니메이션)을 적용하여 시각적 완성도 향상.
- **환경 최적화**: `package.json`에 `"type": "module"`을 추가하여 PostCSS 설정 관련 빌드 경고 해결.

## 2026-02-04: 아이콘 시스템 교체 및 UI 폴리싱
- **아이콘 라이브러리 변경**: 기존 Ant Design Icons 대신 **Material Design Icons (MDI)** 도입 (`@mdi/js`, `@mdi/react`).
  - **이유**: 더 현대적인 라인 스타일(SVG Path)과 풍부한 아이콘셋 확보, `lucide-react`와 유사한 깔끔한 룩앤필 제공.
- **레이아웃 개선 (User Feedback 반영)**:
  - **헤더**: 불필요한 장식(박스 로고)을 제거하고 타이포그래피 중심의 미니멀 디자인 적용.
  - **사이드바**: 콘텐츠가 모서리에 붙는 문제를 해결하기 위해 `px-8 py-6` 패딩 적용.
  - **푸터**: 다운로드 버튼을 플로팅 스타일(Floating Style)로 변경하여 심미성 향상.
  - **컴포넌트**: 단순 텍스트 태그를 Ant Design `Tag` 컴포넌트로 교체하여 시스템 통일성 강화.


## 2026-02-04: UI 아키텍처 변경 (Tabs → Toolbar)
- **배경**: 편집 기능(텍스트, 도형, 지우개)이 늘어남에 따라 기존의 상단 2개 탭(배경/텍스트) 구조로는 확장이 어려움.
- **결정**: 좌측에 **세로형 아이콘 툴바**를 배치하고, 선택된 도구에 따라 세부 속성 패널을 보여주는 방식으로 변경.
- **이유**:
  1.  **확장성**: 추후 스티커, 필터 등 새로운 기능 추가 용이.
  2.  **직관성**: 텍스트도 '추가하고 수정하는' 하나의 도구로 인식하여 일관된 UX 제공. 포토샵/피그마 등 표준 그래픽 툴의 패턴을 따름.
  3.  **공간 효율**: 좁은 탭 헤더보다 아이콘 툴바가 공간을 덜 차지하며 세련된 느낌을 줌.

## 2026-02-04: 아이콘 시스템 MDI(Material Design Icons) 채택
- **이유**: Ant Design Icons보다 종류가 다양하고, 범용적인 디자인 언어(Material Design)를 따르므로 툴바 아이콘의 일관성을 유지하기 좋음.

## 2026-02-04: Tailwind CSS 4.0 적용
- **내용**: `postcss` 설정과 `@import "tailwindcss";` 문법을 사용하여 최신 CSS 프레임워크 적용.

## 2026-02-04: 도형 도구 UX 개선
- **문제**: 도형의 대각선 크기 조절이 비율이 고정(Uniform Scaling)되어 자유롭지 않고, 다중 선택 시 개별 제어가 불가능함.
- **해결**:
  1.  **자유 변형(Free Transform)**: `uniformScaling: false` 옵션을 적용하여 대각선 드래그 시 가로/세로 비율을 자유롭게 조절 가능하도록 변경.
  2.  **다중 선택 지원**: `getActiveObjects()`를 활용하여 여러 객체를 선택했을 때도 색상 변경 및 삭제가 일괄 적용되도록 로직 수정.
  3.  **아이콘 교체**: 직관적인 인지를 위해 `Filled` 스타일 대신 `Outline` 스타일(`rectangle-outline`, `circle-outline`) 아이콘 적용.

## 2026-02-04: 도형 도구 명칭 및 UI 개선 (User Feedback 반영)
- **명칭 변경**: '가리기 도구'를 사용자 직관성을 위해 '**도형도구**'로 변경.
- **레이아웃 수정**: `Space` 컴포넌트의 잘못된 속성(`vertical` -> `direction="vertical"`)을 바로잡아 패널 내 요소들이 가로 너비를 가득 채우도록 수정.
- **아이콘 시인성 개선**: 
  - 사각형/원형 아이콘을 기존 Outline 스타일에서 **Filled 스타일**(`mdiSquare`, `mdiCircle`)로 변경.

### 2026-02-04: 도형 도구 UI 레이블 간소화
- **결정 사항**: 도형 도구의 버튼 레이블에서 " 추가" 접미사를 제거하고 하단 설명을 삭제함.
- **이유**: 사용자가 기능을 직관적으로 이해할 수 있으므로 불필요한 텍스트를 줄여 UI를 더 깔끔하게 유지하기 위함. ("사각형 추가" -> "사각형", "원형 추가" -> "원형")
  - 아이콘 크기를 확대(1.5 -> 2.2)하고 브랜드 컬러(Blue)를 적용하여 시각적 강조.
  - 버튼 높이를 키우고(`h-20` -> `h-28`) 둥근 모서리(`rounded-2xl`)를 적용하여 더 전문적인 느낌을 제공.

## 2026-02-04: 스포이드(Eyedropper) 도구 구현 방식 선정
- **결정**: 브라우저 기본 **EyeDropper API** 활용.
- **이유**: 
  1.  **성능**: Canvas의 `getImageData`를 직접 처리하는 것보다 빠르고 정확함.
  2.  **범위**: 브라우저 창 외부나 캔버스 밖의 영역에서도 색상을 추출할 수 있어 UX가 우수함.
  3.  **간결함**: 추가적인 라이브러리 없이 표준 API로 구현 가능.
- **제약**: 일부 브라우저(Firefox 등)에서 지원되지 않을 수 있으나, 현재 타겟 사용 환경(Chrome/Edge)에서는 최적의 선택으로 판단하여 도입함. (비지원 시 alert 처리)

## 2026-02-04: 모바일 최적화 및 반응형 UI 전략 (개선)
- **일체형 폴딩(Integrated Folding) UI**:
  - **결정**: 기존의 팝업 스타일 패널 대신, 하단 툴바 바로 위에서 어코디언처럼 확장되는 구조를 채택.
  - **이유**: 툴바와 패널 사이의 시각적 분절감을 줄이고 하나의 '편집 도구 세트'로서 일체감 있는 UX를 제공하기 위함.
- **자동 폴딩 및 초기 상태 제어**:
  - **결정**: 캔버스 영역 터치 시 패널 자동 닫힘 기능 구현 및 페이지 첫 진입 시 도구 미선택 상태 유지.
  - **이유**: 캔버스 편집 영역을 최대한 확보하고, 사용자에게 불필요한 정보 노출을 최소화하여 집중도 있는 작업 환경 제공.

## 2026-02-04: 공유 및 내보내기 UX 개선
- **'공유' 탭 신설 및 다운로드 버튼 이동**:
  - **결정**: 기존에 속성 패널 하단에 항상 고정되어 있던 '이미지 다운로드' 버튼을 제거하고, 별도의 **'공유(Share)'** 탭을 신설하여 그 안으로 기능을 이동시킴.
  - **이유**: 
    1.  **작업 흐름 분리**: '편집(Editing)'과 '내보내기(Exporting)' 단계를 명확히 분리하여 사용자가 편집 중에는 도구 속성에만 집중할 수 있도록 함.
    2.  **확장성**: 추후 SNS 공유, 링크 복사 등 다양한 내보내기 옵션을 추가할 공간을 미리 확보함.
- **헤더 버전 정보 제거**:
  - **결정**: 상단 헤더에 표시되던 `v1.0.0` 텍스트를 제거함.
  - **이유**: 사용자에게 불필요한 정보를 최소화하여 더욱 심플하고 몰입감 있는 UI(Minimalism)를 제공하기 위함.

## 2026-02-05: Undo/Redo (실행 취소/다시 실행) 기능 구현
- **기술**: Fabric.js의 `toJSON`과 `loadFromJSON` 메서드를 활용한 상태 기반 히스토리 스택.
- **결정**: 메모리 효율을 위해 히스토리 스택 크기를 50개로 제한.
  - **UI**: 
  - **플로팅 컨트롤**: 캔버스 우측 상단에 Undo/Redo 버튼 배치 (PC/모바일 공통 접근성).
  - **단축키**: 표준 단축키인 `Ctrl+Z` (Undo) 및 `Ctrl+Y` / `Ctrl+Shift+Z` (Redo) 지원.

## 2026-02-05: 모바일 터치 사용성 및 레이어 관리 개선
- **문제**: 모바일 환경에서 캔버스 터치 시 스크롤이 발생하여 조작이 어렵고, 작은 핸들 크기로 인해 선택이 불편함. 또한 객체 선택 시 패널이 화면을 가리는 문제 발생.
- **해결**:
    1.  **Touch Action 제어**: 캔버스 컨테이너에 `style={{ touchAction: 'none' }}`을 적용하여 브라우저 기본 스크롤 동작 차단.
    2.  **Fabric.js 핸들 및 선택 영역 최적화**:
        - `cornerSize: 12`: 핸들 시인성 확보.
              - `padding: 20`: 객체 주변 터치 영역(Hit Area)을 대폭 확대하여 선택 용이성 개선.
              - `targetFindTolerance: 15`: 터치 정밀도가 낮은 모바일 환경을 고려하여 선택 허용 오차 범위 확대.
              - `uniformScaling: false`: 대각선 핸들 조작 시 비율 고정 없이 가로/세로를 자유롭게 변형 가능하도록 설정.
              3.  **패널 자동 열림 조건 수정**: `window.innerWidth >= 768` (태블릿/PC)일 때만 객체 선택 시 패널이 자동으로 열리도록 제한.
              4.  **편집 시 패널 닫힘**: 모바일에서 캔버스 터치(`mouse:down`) 시 열려있던 패널을 강제로 닫아 편집 화면 확보.      5.  **선택 해제 로직 보강**: 빈 공간 터치(`selection:cleared`) 시 선택 상태(`activeObject`, `isTextSelected` 등)를 즉시 초기화하여 UI 동기화.
    - **레이어 관리**:
      - **용어 변경**: 사용자 혼란 방지를 위해 '배경'을 '**이미지**'로 변경.
      - **패널 명칭 통일**: 툴바 아이콘 명칭과 일치하도록 속성 패널의 제목을 '내보내기'에서 '**공유**'로 변경.
  - **기능 구현**: Fabric.js v6 API(`bringObjectToFront` 등)를 활용하여 레이어 순서 변경 기능 및 UI 구현.

## 2026-02-05: UX 개선 - 편집 도구 활성화 조건 강화- **문제**: 배경 이미지가 없는 상태에서 텍스트나 도형을 추가하면 캔버스가 보이지 않아 사용자가 혼란스러울 수 있음.
- **결정**: 배경 이미지가 업로드되기 전(`!hasBackground`)에는 **모든 편집 도구(텍스트, 도형, 브러쉬, 공유)를 비활성화(Disabled)** 처리함.
- **효과**: 사용자가 "이미지 업로드"라는 첫 단계를 명확히 인지하고 순차적으로 작업을 진행하도록 유도.

## 2026-02-07: 편집 모드 이원화 및 UI/UX 고도화
- **편집 모드 분리 (Base vs Meme)**:
  - **Base 모드**: 배경 이미지 설정, 도형(가리기용), 브러쉬 등 밈의 '바탕'을 만드는 도구들로 구성.
  - **Meme 모드**: 텍스트 추가 및 최종 결과물 공유 등 실제 밈 생성 단계
  - **도입 배경**: 모든 도구가 한꺼번에 노출될 경우의 복잡도를 낮추고, 텍스트 편집 단계에서 배경이나 도형이 실수로 조작되는 것을 방지하기 위함.
- **레이어 잠금(Layer Locking) 로직**:
  - Meme 모드 진입 시 텍스트(`fabric.IText`)를 제외한 모든 객체의 `selectable` 및 `evented` 속성을 `false`로 설정하여 편집을 제한함.
- **UI 일관성 개선**:
  - 속성 패널 상단에 `ModeBadge`를 추가하여 사용자가 현재 어떤 단계에 있는지 명확히 인지하도록 개선.
  - 모바일 하단 UI에서도 모드 전환이 원활하도록 `MemeToolbar`와 `MemePropertyPanel`의 Props 전달 방식 수정.
- **객체 조작성 향상**:
  - `uniformScaling: false`를 적용하여 모든 객체(텍스트, 도형 등)의 가로/세로 비율을 자유롭게 조절할 수 있도록 변경.
