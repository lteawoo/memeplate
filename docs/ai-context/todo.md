# Memeplate 개발 TODO

## 1단계: UI 구조 리팩토링 [Completed]
- [x] **Layout 구조 변경**: `Sider` 내부를 `Toolbar`(아이콘)와 `Panel`(속성)로 분할
- [x] **State 관리**: `activeTool` 상태 신설 및 탭 전환 로직 대체
- [x] **Design**: 툴바 아이콘 스타일링 (Active 상태 강조, 툴팁 적용)

## 2단계: 신규 도구 구현 [Completed]
- [x] **도형도구(Shapes)**
  - [x] 사각형/원형 추가 버튼 구현 (UI 고도화 완료)
  - [x] UI 레이블 간소화 (설명 삭제 및 "사각형", "원형"으로 표기)
  - [x] 도형 색상 변경 (ColorPicker 컴포넌트 분리 완료)
  - [x] 도형 속성 단순화 (불투명도, 외곽선 두께 제거)
  - [x] 레이아웃 피팅 및 아이콘 시인성 개선
- [x] **브러쉬(Brush) 도구**
  - [x] Fabric.js `PencilBrush` 활성화 및 색상 연동
  - [x] 브러쉬 크기 슬라이더 구현
  - [x] 브러쉬 모드 toggle 로직 (DrawingMode)
- [x] **스포이드(Eyedropper) 도구**
  - [x] ColorPicker 옆에 스포이드 버튼 배치
  - [x] EyeDropper API 연동을 통한 색상 추출 및 적용

## 3단계: 기능 고도화 및 테스트 [In Progress]
- [x] 각 도구 간 전환 시 캔버스 상태(Selection, DrawingMode) 동기화 처리
- [x] **Undo/Redo (실행 취소/다시 실행) 기능**
  - [x] History Stack 로직 (JSON 기반)
  - [x] 키보드 단축키 연결
  - [x] UI 버튼 구현 (Floating Control)
- [ ] 레이어 순서(Z-index) 관리 기능 추가
- [ ] Playwright E2E 테스트 (도구 전환 및 UI 렌더링 확인)

## 4단계: 코드 리팩토링 및 컴포넌트 분리 [Completed]

- [x] **레이아웃 및 구조 분리**: `MemeEditor.tsx`의 거대한 `return` 문을 주요 레이아웃 단위(`EditorLayout`, `MainHeader`, `EditorSider`, `CanvasArea`)로 분할

- [x] **컴포넌트 단위 분리**:

  - [x] `MemeToolbar`: 좌측 세로 아이콘 툴바 영역 (모바일 대응 완료)

  - [x] `MemePropertyPanel`: 선택된 도구에 따른 속성 패널 분리

  - [x] `MemeCanvas`: 캔버스 렌더링 및 Empty State 영역

- [x] **공통 UI 컴포넌트 정리**: `MemeColorPicker`를 별도 파일로 분리하여 재사용성 확보 (Issue #6)

- [x] **타입 및 린트 정리**: `any` 타입 제거 및 ESLint 규칙 준수



## 5단계: 모바일 최적화 및 UX 개선 [Completed]

- [x] **반응형 레이아웃**: 모바일/데스크탑 분기 처리 (`flex-col` vs `flex-row`)

- [x] **네비게이션**: 모바일 헤더 햄버거 메뉴 구현
  - [x] PC 뷰에서 햄버거 버튼 숨김 처리
  - [x] 모바일 Drawer 메뉴 정렬 및 스타일 개선

- [x] **하단 탭바 & 폴딩 UI**: 모바일 환경에서 툴바 하단 배치 및 **일체형 폴딩(Expansion)** UI 구현 (시각적 검증 완료)

- [x] **사용성 개선**: 캔버스 터치 시 패널 자동 닫힘 및 초기 진입 시 패널 숨김 처리 (시각적 검증 완료)

- [x] **캔버스 최적화**: 모바일 화면 너비에 맞춘 캔버스 리사이징 로직 추가



## 6단계: 기능 고도화 및 테스트
- [x] AI 실행 환경 가이드 작성 (AGENTS.md)
- [x] **공유/내보내기 UX 개선**:
  - [x] '공유' 탭 신설 및 다운로드 버튼 이동
  - [x] 상단 헤더 버전 정보 제거 (Minimal Design)
  - [x] **내보내기 옵션 확장**: PNG, JPG, WEBP, PDF 포맷 선택 지원
  - [x] **클립보드 지원**: 이미지 복사 기능 추가
  - [x] **사용성 개선 (Fix)**: 
    - [x] 캔버스 내부 조작 시에는 패널 유지
    - [x] 캔버스 외부(배경) 터치 시에는 패널 닫힘 (Robust Interaction)
  - [x] **UI 단순화**: 불필요한 설명 텍스트 제거하고 즉시 기능 제공
  - [x] **UX 개선**: 이미지 업로드 전 편집 도구(텍스트, 도형, 브러쉬, 공유) 비활성화
- [x] **편집 모드 이원화 (Base / Meme)**:
  - [x] 모드별 도구 분리 및 툴바 UI 업데이트
  - [x] 캔버스 객체 잠금 로직 구현
  - [x] 속성 패널 내 모드 표시용 Badge 추가
- [x] 레이어 순서(Z-index) 관리 기능 추가
- [x] **Undo/Redo 지원**: Ctrl+Z/Y 단축키 및 버튼 추가
- [x] **UI/UX 정교화 (Design Polish)**:
  - [x] 8px 그리드 시스템 전면 적용 및 레이아웃 여백 재조정
  - [x] MemeToolbar 버튼 디자인 단순화 및 모드 스위처와 일관성 통합
  - [x] 불필요한 인디케이터 제거 및 8px 그리드 시스템 최적화
  - [x] **8px 그리드 시스템 엄격 적용 (Fix)**: Tailwind 홀수 단위(3, 1.5 등) 제거 및 짝수 단위(2, 4 등)로 전면 교체
  - [x] PropertyPanel 내부 섹션 간격 및 컴포넌트 크기 최적화

## 8단계: 모드 스위처 UX 개선 [#9] [Completed]
- [x] **컴포넌트 분리**: `MemeModeSwitcher.tsx` 생성 및 스타일 이관
- [x] **MemeToolbar 경량화**: 내부 스위처 로직 제거 및 순수 툴바화
- [x] **MemeEditor 레이아웃 수정**:
  - [x] Mobile: `MainHeader`와 `Canvas` 사이에 스위처 배치
  - [x] Desktop: `EditorSidebar` 내부에 스위처 재배치

## 9단계: 모바일 레이어 관리 최적화 [#10] [Completed]
- [x] **터치 동작 개선**: 레이어 제어 버튼에서 `Tooltip` 제거 및 이벤트 버블링 차단
- [x] **레이어 UI 안정화**: 모바일 환경에서의 오동작 방지

## 10단계: 모바일 터치 인터랙션 정교화 [#11] [Completed]
- [x] **도형 선택 로직 수정**: `mouse:down` 시 배경 터치와 객체 터치를 구분하여 패널 닫힘 제어
- [x] **선택 피드백 강화**: 모바일에서도 객체 선택 시 속성 패널이 즉시 열리도록 개선
- [x] **객체 속성 보강**: 신규 추가 객체에 대한 `selectable` 속성 동기화
- [x] **이벤트 격리**: 캔버스 내부 클릭이 상위 배경 클릭 핸들러로 전파되지 않도록 차단

## 11단계: 모바일 레이아웃 최종 안정화 [#13] [Completed]
- [x] **UI 투과 처리**: 모바일 하단 컨테이너의 `pointer-events` 속성 제어로 하단 캔버스 영역 터치 활성화
- [x] **레이아웃 보정**: 패널이 닫혀 있을 때 화면 영역을 차지하지 않도록 구조 최적화

## 12단계: 선택 로직 및 UX 정교화 [#14] [Completed]
- [x] **Deselection 구현**: 캔버스 외부 클릭 시 모든 활성 객체 선택 해제 로직 추가
- [x] **모바일 동기화**: 배경 클릭 시 패널 닫힘과 선택 해제 동작 통합

## 13단계: 모바일 슬림 UI 리팩토링 [#15] [Completed]
- [x] **MemePropertyPanel 슬림 모드 구현**: 가로형 레이아웃 및 스크롤 적용
- [x] **동적 높이 조절**: 객체 선택 여부에 따른 패널 높이 전환 로직
- [x] **컴팩트 컴포넌트**: 모바일용 소형 슬라이더 및 컬러피커 스타일링

## 14단계: 유지보수 및 경고 제거 [#16] [Completed]
- [x] **Drawer API 업데이트**: deprecated된 `width` 속성을 `styles.wrapper`로 대체

## 15단계: 도구 체계 전면 리팩토링 [#17] [Completed]
- [x] **모드 통합**: `editMode` 제거 및 단일 편집 환경 구축
- [x] **지우개 기능 통합**: 도형 + 브러쉬 -> '지우개' 탭으로 단일화
- [x] **툴바 재설계**: [이미지, 텍스트, 지우개, 레이어, 공유] 순서로 재배치
- [x] **코드 정리**: `MemeModeSwitcher` 삭제 및 미사용 로직 제거

## 18단계: 도구 체계 초간소화 및 통합 편집 패널 [#21] [Completed]
- [x] **MemeToolbar 개편**: [이미지, 편집, 공유] 3대 버튼으로 축소
- [x] **통합 리스트 UI**: 텍스트/도형 구분 없는 단일 관리 목록 구축
- [x] **레이어 기능 통합**: 목록 내 Up/Down 버튼으로 순서 조절 구현
- [x] **패널 구조 정리**: 불필요한 레이어 전용 섹션 및 상태 제거

## 19단계: 캔버스 작업 영역 확장 및 경계 제한 [#22] [Completed]
- [x] **Safe Area 도입**: 60px 여백(`CANVAS_MARGIN`)을 추가하여 선택 박스 잘림 해결
- [x] **이동 제한 구현**: `object:moving` 이벤트를 통한 작업 영역 이탈 방지
- [x] **배경 레이어화**: `backgroundImage`를 일반 레이어로 전환하여 제어력 강화
- [x] **크롭 내보내기**: 여백을 제외한 실제 작업 영역만 다운로드/복사되도록 구현

## 21단계: 기능 안정화 및 버그 수정 [New] [Completed]
- [x] **도구 비활성화 로직 구현**: 이미지가 없을 때 편집/공유 탭 비활성화 (Issue #23)
- [x] **도형 도구 UI 개선**: 원형(Circle) 추가 버튼 구현 (Issue #24)
- [x] **Undo/Redo 동기화**: 히스토리 복원 시 레이어 리스트 State 동기화 (Issue #25)

## 20단계: 코드 품질 및 환경 설정 안정화 [Completed]
- [x] **TypeScript 엄격 모드 대응**: `FabricObject` 타입 확장 및 이벤트 매개변수 타입 최적화
- [x] **Lint 경고 전면 제거**: 미사용 프로퍼티 제거 및 규칙 준수
- [x] **노드 타입 정의 추가**: `tsconfig.node.json` 정상화를 위한 `@types/node` 도입
